# DFT. 이산 푸리에 변환

변환이라는 것은 어떤 것을 다른 무언가로 바꾸는 것을 의미한다. 우리는 어떤 $(n-1)$차 다항함수를 나타낼 때, $n$개의 계수를 이용하여 표현할 수 있음을 안다. 한편 다른 방법으로, 다항함수의 정의역에서 서로다른 $n$개의 원소에 대하여 값을 알고 있다면 그 다항함수가 유일하게 정의되는 것도 알고 있다. 그럼 이때, 다항함수의 계수에서, 다항함수의 서로 다른 $n$개의 입력에 대한 값으로 바꿔주는 변환을 구할 수 있지 않을까? 시작해보자. 

$(n - 1)$차 다항함수는 다음과 같은 꼴로 표현된다.

$$f(x) = \sum_{i = 0} ^{n - 1} a_i x^i$$

이때 $a_0 , \cdots ,a_{n-1}$은 상수가 될 것이다. 우리는 이러한 다항함수를 다음과 같은 벡터로 표시할 수 있다. 

$$\vec{v} = [a_0, a_1, \cdots, a_{n-1}]$$

한편, $f(x)$를 $\vec{v}$와 내적을 이용해서 표현한다면, 

$$f(x) = \vec{v} \bullet [x^0, x^1, \cdots, x^{n-1}]$$
로 표현할 수 있다. 

한편 우리는 $(n-1)$차 다항함수의 계수를 서로다른 $n$개의 $x_i$에 대하여 $f(x_i)$를 알고 있을 때 다음과 같은 방법으로 다항함수의 계수를 구할 수 있다.

서로 다른 $x_0, x_1, \cdots, x_{n-1}$을 이용하면 행렬을 이용하여

$$\begin{pmatrix}
x_0^0 & \cdots & x_0^{n - 1}
\\ x_1^0 & \cdots & x_1^{n - 1}
\\ \vdots & \ddots & \vdots
\\ x_{n-1}^0 & \cdots & x_{n-1}^{n - 1}
\end{pmatrix}
\begin{pmatrix}
a_0 \\ a_1 \\ \vdots \\ a_{n-1}
\end{pmatrix} = 
\begin{pmatrix}
f(x_0) \\ f(x_1) \\ \vdots \\ f(x_{n-1})
\end{pmatrix}$$

다음과 같은 형태로 나타낼 수 있다. 이때 위의 식을

$$A\vec{v} = \vec{w}$$

라고 하자. 그러면 우리는 $[x_0, x_1, \cdots, x_{n-1}]$가 주어졌을 때, 함수의 결과 $[f(x_0), f(x_1), \cdots, f(x_{n-1})]$를 알고 있다면, 함수의 계수인 $[a_0, a_1, \cdots, a_{n-1}]$을 $\vec{v} = A^{-1}\vec{w}$로 알아낼 수 있다. 


그럼 이때 행렬 $A$에 대한 변환인 $L_A (\vec{v}) = A\vec{v}$를 찾을 수 있다. 이산 푸리에 변환은 이러한 변환 $L_A$의 특수한 형태이다.

우리는 이 $n$개의 $x_i$값을 결정해야 한다. 그냥 $0, 1, 2, 3, \cdots, n - 1$로도 결정할 수 있겠지만, 이를 이용해서 행렬 $A$를 구하면,
$x_{n-1}$의 값이 커지고 이의 $n-1$승을 연산하면, 엄청나게 수가 커질 것이다. 따라서 단순히 실수를 이용한다면, 이렇게 연산한 값이 너무 커지거나, 너무 작아지는 문제가 분명히 존재한다. 따라서 다음과 같은 복소수를 이용한다. 

$$w=e^{\frac{2\pi i}{n}}$$

이 복소수의 특징은 크기가 1이고, 복소평면 위의 단위원을 $n$등분하는 점에 위치한다는 것이다. 이 수는 $w^n - 1=(w -1)(w^{n-1} + w^{n-2 } + \cdots + w + 1)=0$을 만족한다.

그림으로 $n=6$인 경우를 표시하면 다음과 같다. 

![picture 3](images/a5803b2d9b1c553eea37454551673f50b7509f29ca2f824d4496a25ecb313177.png)  

즉 $w_i = w^i$는 복소평면의 단위원을 $n$등분했을 때 $i$번째로 위치하는 점을 의미한다. 이렇게 되면 $w$에 어떤 거듭제곱을 해도, 그 수는 다시 $w_i$안에 포함되게 된다. 이러한 복소수의 이점을 살린다면, 실수에서 발생할 수 있는 문제점을 해결할 수 있다. 따라서 이 단위원 위의 $n$개의 점을 나타내는 $w$를 이용하도록 하자.

이 단위원 위의 $w_i$를 $x_i$로 간주할 때, 즉 $x_i = w_i = w^i$일 때의 $L_A$를 **이산푸리에 변환**이라고 부른다(혹은 $w=e^{-\frac{2\pi i}{n}}$로 정의한 것을 사용하기도 한다).

그러면 $L_A$를 구성하는 A는 어떻게 생겼을까? 그 형태는 다음과 같다.

$$\begin{pmatrix}
w_0^0 & \cdots & w_0^{n - 1}
\\ w_1^0 & \cdots & w_1^{n - 1}
\\ \vdots & \ddots & \vdots
\\ w_{n-1}^0 & \cdots & w_{n-1}^{n - 1}
\end{pmatrix}= 
\begin{pmatrix}
w^{(0)(0)} & \cdots & w^{(0)(n-1)}
\\ w^{(1)(0)} & \cdots & w^{(1)(n - 1)}
\\ \vdots & \ddots & \vdots
\\ w^{(n-1)(0)} & \cdots & w^{(n-1)(n - 1)}
\end{pmatrix}$$

그럼 이제 푸리에 역변환은? $L_{A^{-1}}$이 될 것이다! 

한편, 이산 푸리에 변환을 나타내는 행렬은 모든 행 혹은 열이 독립이다. 행렬의 임의의 두 행을 뽑아서 하나의 행에는 켤레를 취해서 내적을 해보면, 무조건 0이 됨을 쉽게 알 수 있다. 또, 같은 행렬을 서로 내적하면 $n$이 되는 것도 알 수 있다. $\bar{w}$를 $w$의 켤레복소수라 한다면, 즉, $\bar{w} = e^{-\frac{2\pi i}{n}}$라면 다음이 성립한다.

$$
\begin{pmatrix}
w^{(0)(0)} & \cdots & w^{(0)(n-1)}
\\ w^{(1)(0)} & \cdots & w^{(1)(n - 1)}
\\ \vdots & \ddots & \vdots
\\ w^{(n-1)(0)} & \cdots & w^{(n-1)(n - 1)}
\end{pmatrix}
\begin{pmatrix}
\bar{w}^{(0)(0)} & \cdots & \bar{w}^{(0)(n-1)}
\\ \bar{w}^{(1)(0)} & \cdots & \bar{w}^{(1)(n - 1)}
\\ \vdots & \ddots & \vdots
\\ \bar{w}^{(n-1)(0)} & \cdots & \bar{w}^{(n-1)(n - 1)}
\end{pmatrix} = nI
$$

따라서 위의 사실을 통해, $A$의 역행렬은 다음과 같음을 알 수 있다.

$$A^{-1} = \frac{1}{n}\begin{pmatrix}
\bar{w}^{(0)(0)} & \cdots & \bar{w}^{(0)(n-1)}
\\ \bar{w}^{(1)(0)} & \cdots & \bar{w}^{(1)(n - 1)}
\\ \vdots & \ddots & \vdots
\\ \bar{w}^{(n-1)(0)} & \cdots & \bar{w}^{(n-1)(n - 1)}
\end{pmatrix}
$$

위의 역행렬을 이용하면, $w_i$의 함수값을 이용해서 다항식의 계수를 구할 수 있다!

$$a_j = \frac{1}{n} \sum_{i=0}^{n-1}f(w_i)\bar{w}^{ij}$$

# 이산 푸리에 변환의 합성곱

변환은 변환만 한다고 그 자체로 의미가 있지는 않다. 라플라스 변환의 경우, 미분방정식을 라플라스 변환하여 대수적으로 해결할 수 있는 능력이 있는 것처럼, 이산 푸리에 변환도 어떤 문제를 쉽게 해결할 좋은 능력을 가지고 있다.

어떤 두 다항식을 벡터로 나타낸다면 $\vec{a} = [a_0,a_1,\cdots,a_{n-1}]$과 $\vec{b} = [b_0,b_1,\cdots,b_{n-1}]$로 나타낼 수 있을 것이다. 이 둘을 이산 푸리에 변환한다면 $\vec{A} = [A_0,A_1,\cdots,A_{n-1}]$과 $\vec{B} = [B_0,B_1,\cdots,B_{n-1}]$라고 할 수 있을 것이다. 이때 $A, B$의 원소를 서로 곱하고 다시 역변환을 하면 어떻게 될까?

우선 $a_i$ $b_i$ $A_j$ $B_j$는 다음을 만족한다.


$$a_i = \frac{1}{n} \sum_{j=0}^{n-1}A_i \bar{w}^{ij}, b_i = \frac{1}{n} \sum_{j=0}^{n-1}B_i \bar{w}^{ij}$$
$$A_j = \sum_{i=0}^{n-1}a_i w^{ij}, B_j = \sum_{i=0}^{n-1}b_i w^{ij}$$

이때 $\vec{C}$를 $(C_j)=(A_j B_j)$로 정의하는 경우에, 즉 합성곱을 한 경우에 이 역변환을 살펴보자. 

$$\begin{align}
L_{A^{-1}}(C)_k &= c_k = \frac{1}{n} \sum_{j=0}^{n-1}A_jB_j\bar{w}^{jk} = \frac{1}{n} \sum_{j=0}^{n-1}\left[ \sum_{i=0}^{n-1}a_iw^{ij} \right]B_j\bar{w}^{jk} \\ &= \sum_{i=0}^{n-1}a_i \left[ \frac{1}{n} \sum_{j=0}^{n-1} B_j \bar{w}^{j(k-i)} \right] \\ &= \sum_{i=0}^{n-1}a_i b_{k-i}
\end{align}$$

즉, $c_k$는 다음과 같다.

$$c_k = \sum_{i=0}^{n-1}a_i b_{k-i}$$

이게 도대체 뭘 의미할까? 이 꼴을 볼 수 있는 형태는 두 다항식을 곱했을 때 나타난다. 위의 예시에서, $a_0x^0 + a_1x^1 + \cdots + a_{n-1}x^{n-1}$ 과 $b_0x^0 + b_1x^1 + \cdots + b_{n-1}x^{n-1}$를 곱하는 경우, $x^k$의 계수는 어떻게 되는가? 아래와 같이 될 것이다. 

$$a_0 b_k + a_1 b_{k-1} + \cdots + a_kb_0$$

즉, 위에서 봤던 꼴이 나온다! 즉, 합성곱을 한 결과의 푸리에 역변환은 두 다항식의 곱셈에 대한 계수를 출력한다는 것을 알 수 있다. 

# FFT. 고속푸리에 변환

위의 풀이를 코드로 구현한다고 하자. 일반적으로 계산한다면, $n$개의 값에 대하여 $n$번의 루프를 돌아야하므로 $O(n^2)$의 시간복잡도가 걸릴 것이다. 따라서 이를 줄이기 위해 고속푸리에 변환이라는 테크닉을 이용한다. 

우선 고속푸리에 변환에서는 $n$을 $2$의 거듭제곱으로 고정하고 시작한다. 두 다항식을 곱했을 때 나오는 결과차수보다 큰 $2^k - 1$인 $k$를 구하고, 그 자리에 맞춰서 다항식을 벡터로 바꿔준다. 

$2$의 거듭제곱에서 1을 뺀 값으로 다항함수를 표현한다면 우함수인 항과 기함수의 항이 같음을 알 수 있다. 이 다항함수를 우함수와 기함수로 분해해준다. 

$$\begin{align}
f(x) &= a_0x^0 + \cdots + a_nx^n = a_0x^0+a_2x^2+\cdots+a_{n-1}x^{n-1}+a_1x^1+a_3x^3+\cdots+a_nx^n \\ &= f_{even}(x)+f_{odd}(x)
\end{align}$$

그리고 뒤에 나오는 $f_{even}$과 $f_{odd}$도 $x^2$을 $x$로 치환하고 똑같이 분해해준다. 계속 그렇게 분할하고 더 분할할 수 없을 때 푸리에 변환을 적용한다.






이를 수식을 이용하여 접근해보자.

$$\begin{pmatrix}
f(w_0) \\ f(w_1) \\ \vdots \\ f(w_{n-1})
\end{pmatrix}=
\begin{pmatrix}
w_0^0 & \cdots & w_0^{n - 1}
\\ w_1^0 & \cdots & w_1^{n - 1}
\\ \vdots & \ddots & \vdots
\\ w_{n-1}^0 & \cdots & w_{n-1}^{n - 1}
\end{pmatrix}
\begin{pmatrix}
a_0 \\ a_1 \\ \vdots \\ a_{n-1}
\end{pmatrix} = 
\begin{pmatrix}
a
\end{pmatrix}
$$